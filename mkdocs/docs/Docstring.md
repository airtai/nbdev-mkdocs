---
output-file: docstring.html
title: Docstring helpers

---


<!-- WARNING: THIS FILE WAS AUTOGENERATED! DO NOT EDIT! -->


```
import pytest
import numpy as np
```


```
logger.warning("xs")
```

    WARNING:__main__:xs



```
def f(i: str, *, a: int = 0):
    """Very cool function

    **f** is a very cool function

    Args:
        i: something
        a: something else

    Example:
        The following snippet prints out greetings for two names:
        ```python
        print("hello {fill in name_1}")
        print("goodbye {fill in name_2}")
        ```


    Example:
        Yet another example
        ```python
        password = {fill in password}
        print(f"this is your password: {password}")


        from  nbdev_mkdocs.docstring import run_examples_from_docstring

        print("Logging in...")
        ```

    """
    raise NotImplemented()
```


```

```


```
def g():
    """Function

    Example:
        ```python
        from airt.helpers import print_header

        print("hello world")
        ```

    Example:
        ``` python
        from nbdev_mkdocs.package_data import get_root_data_path

        req_path = get_root_data_path() / "requirements.txt"
        print(f"Path is: {req_path.resolve()}")
        assert req_path.exists()
        ```
    """


_extract_examples_from_docstring(g)
```




    ['\nfrom airt.helpers import print_header\n\nprint("hello world")\n',
     '\nfrom nbdev_mkdocs.package_data import get_root_data_path\n\nreq_path = get_root_data_path() / "requirements.txt"\nprint(f"Path is: {req_path.resolve()}")\nassert req_path.exists()\n']




```
_extract_examples_from_docstring(f)
```




    ['\nprint("hello {fill in name_1}")\nprint("goodbye {fill in name_2}")\n',
     '\npassword = {fill in password}\nprint(f"this is your password: {password}")\n\n\nfrom  nbdev_mkdocs.docstring import run_examples_from_docstring\n\nprint("Logging in...")\n']




```
expected = [
    textwrap.dedent(
        """
            print("hello {fill in name_1}")
            print("goodbye {fill in name_2}")
        """
    ),
    textwrap.dedent(
        """
            password = {fill in password}
            print(f"this is your password: {password}")


            from  nbdev_mkdocs.docstring import run_examples_from_docstring
            
            print("Logging in...")
        """
    ),
]

examples = _extract_examples_from_docstring(f)
for example in examples:
    print(example)

np.testing.assert_array_equal(examples, expected)
```


<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace;font-size:.68rem">
<span style="color: #800080; text-decoration-color: #800080; font-weight: bold">print</span><span style="font-weight: bold">(</span><span style="color: #008000; text-decoration-color: #008000">"hello {fill in name_1}"</span><span style="font-weight: bold">)</span>
<span style="color: #800080; text-decoration-color: #800080; font-weight: bold">print</span><span style="font-weight: bold">(</span><span style="color: #008000; text-decoration-color: #008000">"goodbye {fill in name_2}"</span><span style="font-weight: bold">)</span>

</pre>




<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace;font-size:.68rem">
password = <span style="font-weight: bold">{</span>fill in password<span style="font-weight: bold">}</span>
<span style="color: #800080; text-decoration-color: #800080; font-weight: bold">print</span><span style="font-weight: bold">(</span>f"this is your password: <span style="font-weight: bold">{</span>password<span style="font-weight: bold">}</span>"<span style="font-weight: bold">)</span>


from  nbdev_mkdocs.docstring import run_examples_from_docstring

<span style="color: #800080; text-decoration-color: #800080; font-weight: bold">print</span><span style="font-weight: bold">(</span><span style="color: #008000; text-decoration-color: #008000">"Logging in..."</span><span style="font-weight: bold">)</span>

</pre>




```
examples[0] == expected[0]
```




    True




```

```


```

```


```
expected = ["name_1", "name_2", "password"]

keywords = _get_keywords(examples)

np.testing.assert_array_equal(keywords, expected)
```


```
expected = [
    textwrap.dedent(
        """
            print("hello davor")
            print("goodbye kumaran")
        """
    ),
    textwrap.dedent(
        """
            password = 'not_a_password'
            print(f"this is your password: {password}")
            

            from  nbdev_mkdocs.docstring import run_examples_from_docstring

            print("Logging in...")
        """
    ),
]

actual = _replace_keywords(
    examples, name_1="davor", name_2="kumaran", password="'not_a_password'"
)
for x in actual:
    print(x)

np.testing.assert_array_equal(actual, expected)
```


<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace;font-size:.68rem">
<span style="color: #800080; text-decoration-color: #800080; font-weight: bold">print</span><span style="font-weight: bold">(</span><span style="color: #008000; text-decoration-color: #008000">"hello davor"</span><span style="font-weight: bold">)</span>
<span style="color: #800080; text-decoration-color: #800080; font-weight: bold">print</span><span style="font-weight: bold">(</span><span style="color: #008000; text-decoration-color: #008000">"goodbye kumaran"</span><span style="font-weight: bold">)</span>

</pre>




<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace;font-size:.68rem">
password = <span style="color: #008000; text-decoration-color: #008000">'not_a_password'</span>
<span style="color: #800080; text-decoration-color: #800080; font-weight: bold">print</span><span style="font-weight: bold">(</span>f"this is your password: <span style="font-weight: bold">{</span>password<span style="font-weight: bold">}</span>"<span style="font-weight: bold">)</span>


from  nbdev_mkdocs.docstring import run_examples_from_docstring

<span style="color: #800080; text-decoration-color: #800080; font-weight: bold">print</span><span style="font-weight: bold">(</span><span style="color: #008000; text-decoration-color: #008000">"Logging in..."</span><span style="font-weight: bold">)</span>

</pre>




```
width = 80

console=Console(width=width)
# panel = Panel(
g =    Group(
        Rule("Code"),
        "print(\"stuff\")",
        _format_output(
            "hello world and one more time world", title="output", width=width
        ),
        _format_output(
            "hello world and one more time world",
            title="output",
            sub_dict={"world": "*****"},
            width=width,
        ),
        _format_output(
            "hello world and one more time world",
            title="output",
            sub_dict={"world": "*****"},
            supress=True,
            width=width,
        ),
    )#,
#     title="Test: _format_output()",
#     width=width
# )
# console.print(panel)
console.print(g)
```


<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace;font-size:.68rem"><span style="color: #00ff00; text-decoration-color: #00ff00">───────────────────────────────────── </span>Code<span style="color: #00ff00; text-decoration-color: #00ff00"> ─────────────────────────────────────</span>
<span style="color: #800080; text-decoration-color: #800080; font-weight: bold">print</span><span style="font-weight: bold">(</span><span style="color: #008000; text-decoration-color: #008000">"stuff"</span><span style="font-weight: bold">)</span>
<span style="color: #00ff00; text-decoration-color: #00ff00">──────────────────────────────────── </span>output<span style="color: #00ff00; text-decoration-color: #00ff00"> ────────────────────────────────────</span>
hello world and one more time world
<span style="color: #00ff00; text-decoration-color: #00ff00">──────────────────────────────────── </span>output<span style="color: #00ff00; text-decoration-color: #00ff00"> ────────────────────────────────────</span>
hello ***** and one more time *****
<span style="color: #00ff00; text-decoration-color: #00ff00">─────────────────────────────── </span>output supressed<span style="color: #00ff00; text-decoration-color: #00ff00"> ───────────────────────────────</span>
N/A
</pre>




```
#|output: asis
#| echo: false
show_doc(run_examples_from_docstring)
```




---

[source](https://github.com/airtai/nbdev_mkdocs/blob/main/nbdev_mkdocs/docstring.py#L128){target="_blank" style="float:right; font-size:smaller"}

### run_examples_from_docstring

>      run_examples_from_docstring (o:Any, supress_stdout:bool=False,
>                                   supress_stderr:bool=False,
>                                   sub_dict:Union[Dict[str,str],NoneType]=None,
>                                   width:Union[int,NoneType]=80, **kwargs)

Runs example from a docstring

Parses docstring of an objects looking for examples. The examples are then saved into files and executed
in a separate process.

Note:
    Execution context is not the same as the one in the notebook because we want examples to work from
    user code. Make sure you compiled the library prior to executing the examples, otherwise you might
    be running them agains an old version of the library.

Args:
    o: an object, typically a function or a class, for which docstring is being parsed for examples
    supress_stdout: omit stdout from output, typically due to security considerations
    supress_stderr: omit stderr from output, typically due to security considerations
    sub_dict: a dictionary mapping regexp patterns into replacement strings used to mask stdout and
        stderr, typically used to mask sensitive information such as passwords

    **kwargs: arguments use to replace "{fill in **param**}" in docstring with the actual values when running examples

Raises:
    ValueError: if some params are missing from the **kwargs**
    RuntimeException: if example fails

Example:
    ```python
    from  nbdev_mkdocs.docstring import run_examples_from_docstring

    def f():
        ```python
        Example:
            print("Hello {fill in name}!")
            print("Goodbye {fill in other_name}!")
        ```
        pass

    run_examples_from_docstring(f, name="John", other_name="Jane")
    ```




```
print(run_examples_from_docstring.__doc__)
```


<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace;font-size:.68rem">Runs example from a docstring

    Parses docstring of an objects looking for examples. The examples are then saved into files and executed
    in a separate process.

    Note:
        Execution context is not the same as the one in the notebook because we want examples to work from
        user code. Make sure you compiled the library prior to executing the examples, otherwise you might
        be running them agains an old version of the library.

    Args:
        o: an object, typically a function or a class, for which docstring is being parsed for examples
        supress_stdout: omit stdout from output, typically due to security considerations
        supress_stderr: omit stderr from output, typically due to security considerations
        sub_dict: a dictionary mapping regexp patterns into replacement strings used to mask stdout and
            stderr, typically used to mask sensitive information such as passwords

        **kwargs: arguments use to replace <span style="color: #008000; text-decoration-color: #008000">"{fill in **param**}"</span> in docstring with the actual values when running 
examples

    Raises:
        ValueError: if some params are missing from the **kwargs**
        RuntimeException: if example fails

    Example:
        ```python
        from  nbdev_mkdocs.docstring import run_examples_from_docstring

        def <span style="color: #800080; text-decoration-color: #800080; font-weight: bold">f</span><span style="font-weight: bold">()</span>:
            ```python
            Example:
                <span style="color: #800080; text-decoration-color: #800080; font-weight: bold">print</span><span style="font-weight: bold">(</span><span style="color: #008000; text-decoration-color: #008000">"Hello {fill in name}!"</span><span style="font-weight: bold">)</span>
                <span style="color: #800080; text-decoration-color: #800080; font-weight: bold">print</span><span style="font-weight: bold">(</span><span style="color: #008000; text-decoration-color: #008000">"Goodbye {fill in other_name}!"</span><span style="font-weight: bold">)</span>
            ```
            pass


        <span style="color: #800080; text-decoration-color: #800080; font-weight: bold">run_examples_from_docstring</span><span style="font-weight: bold">(</span>f, <span style="color: #808000; text-decoration-color: #808000">name</span>=<span style="color: #008000; text-decoration-color: #008000">"John"</span>, <span style="color: #808000; text-decoration-color: #808000">other_name</span>=<span style="color: #008000; text-decoration-color: #008000">"Jane"</span><span style="font-weight: bold">)</span>
        ```

</pre>




```
examples = _extract_examples_from_docstring(run_examples_from_docstring)

console = Console(width=80)
console.print(Panel(examples[0]))
```

    ERROR:griffe.agents.nodes:Failed to parse annotation from 'Name' node: 'NoneType' object has no attribute 'resolve'
    ERROR:griffe.agents.nodes:Failed to parse annotation from 'Name' node: 'NoneType' object has no attribute 'resolve'



<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace;font-size:.68rem">╭──────────────────────────────────────────────────────────────────────────────╮
│                                                                              │
│ from  nbdev_mkdocs.docstring import run_examples_from_docstring              │
│                                                                              │
│ def f():                                                                     │
│     ```python                                                                │
│     Example:                                                                 │
│         print("Hello {fill in name}!")                                       │
│         print("Goodbye {fill in other_name}!")                               │
│     ```                                                                      │
│     pass                                                                     │
│                                                                              │
│                                                                              │
│ run_examples_from_docstring(f, name="John", other_name="Jane")               │
│                                                                              │
╰──────────────────────────────────────────────────────────────────────────────╯
</pre>




```

```


```
run_examples_from_docstring(
    f,
    name_1="davor",
    name_2="all",
    password='"zeko"',
    supress_stderr=True,
    sub_dict={"zeko": "*" * 12},
)
```


<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace;font-size:.68rem">Example:
<span style="color: #00ff00; text-decoration-color: #00ff00">───────────────────────────────────── </span>code<span style="color: #00ff00; text-decoration-color: #00ff00"> ─────────────────────────────────────</span>

    <span style="color: #800080; text-decoration-color: #800080; font-weight: bold">print</span><span style="font-weight: bold">(</span><span style="color: #008000; text-decoration-color: #008000">"hello {fill in name_1}"</span><span style="font-weight: bold">)</span>
    <span style="color: #800080; text-decoration-color: #800080; font-weight: bold">print</span><span style="font-weight: bold">(</span><span style="color: #008000; text-decoration-color: #008000">"goodbye {fill in name_2}"</span><span style="font-weight: bold">)</span>

<span style="color: #00ff00; text-decoration-color: #00ff00">──────────────────────────────────── </span>stdout<span style="color: #00ff00; text-decoration-color: #00ff00"> ────────────────────────────────────</span>
hello davor
goodbye all

<span style="color: #00ff00; text-decoration-color: #00ff00">─────────────────────────────── </span>stderr supressed<span style="color: #00ff00; text-decoration-color: #00ff00"> ───────────────────────────────</span>
N/A
</pre>




<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace;font-size:.68rem">Example:
<span style="color: #00ff00; text-decoration-color: #00ff00">───────────────────────────────────── </span>code<span style="color: #00ff00; text-decoration-color: #00ff00"> ─────────────────────────────────────</span>

    password = <span style="font-weight: bold">{</span>fill in password<span style="font-weight: bold">}</span>
    <span style="color: #800080; text-decoration-color: #800080; font-weight: bold">print</span><span style="font-weight: bold">(</span>f"this is your password: <span style="font-weight: bold">{</span>password<span style="font-weight: bold">}</span>"<span style="font-weight: bold">)</span>


    from  nbdev_mkdocs.docstring import run_examples_from_docstring

    <span style="color: #800080; text-decoration-color: #800080; font-weight: bold">print</span><span style="font-weight: bold">(</span><span style="color: #008000; text-decoration-color: #008000">"Logging in..."</span><span style="font-weight: bold">)</span>

<span style="color: #00ff00; text-decoration-color: #00ff00">──────────────────────────────────── </span>stdout<span style="color: #00ff00; text-decoration-color: #00ff00"> ────────────────────────────────────</span>
this is your password: ************
Logging in<span style="color: #808000; text-decoration-color: #808000">...</span>

<span style="color: #00ff00; text-decoration-color: #00ff00">─────────────────────────────── </span>stderr supressed<span style="color: #00ff00; text-decoration-color: #00ff00"> ───────────────────────────────</span>
N/A
</pre>




```
with pytest.raises(ValueError) as e:
    run_examples_from_docstring(f, name_1="davor")

e.value
```




    ValueError("{'password', 'name_2', 'name_1'} > {'name_1'}")




```
class C:
    """Cool class with broken example

    Example:
        ```python
        from nbdev_mkdocs.docstring import run_examples_from_docstring

        raise NotImplementedError("expected to fail")
        ```
    """

    pass
```


```
with pytest.raises(RuntimeError) as e:
    run_examples_from_docstring(C)
e.value
```


<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace;font-size:.68rem">Example:
<span style="color: #00ff00; text-decoration-color: #00ff00">───────────────────────────────────── </span>code<span style="color: #00ff00; text-decoration-color: #00ff00"> ─────────────────────────────────────</span>

    from nbdev_mkdocs.docstring import run_examples_from_docstring

    raise <span style="color: #800080; text-decoration-color: #800080; font-weight: bold">NotImplementedError</span><span style="font-weight: bold">(</span><span style="color: #008000; text-decoration-color: #008000">"expected to fail"</span><span style="font-weight: bold">)</span>

<span style="color: #00ff00; text-decoration-color: #00ff00">──────────────────────────────────── </span>stdout<span style="color: #00ff00; text-decoration-color: #00ff00"> ────────────────────────────────────</span>

<span style="color: #00ff00; text-decoration-color: #00ff00">──────────────────────────────────── </span>stderr<span style="color: #00ff00; text-decoration-color: #00ff00"> ────────────────────────────────────</span>
INFO:nbdev_mkdocs.docstring:rich.jupyter.<span style="color: #808000; text-decoration-color: #808000">JUPYTER_HTML_FORMAT</span>=<span style="color: #008000; text-decoration-color: #008000">'&lt;pre </span>
<span style="color: #008000; text-decoration-color: #008000">style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,\'De</span>
<span style="color: #008000; text-decoration-color: #008000">jaVu Sans Mono\',consolas,\'Courier </span>
<span style="color: #008000; text-decoration-color: #008000">New\',monospace;font-size:.68rem"&gt;{code}&lt;/pre&gt;\n'</span>
Traceback <span style="font-weight: bold">(</span>most recent call last<span style="font-weight: bold">)</span>:
  File <span style="color: #008000; text-decoration-color: #008000">"/tmp/tmpdtxm71jc/example.py"</span>, line <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4</span>, in <span style="font-weight: bold">&lt;</span><span style="color: #ff00ff; text-decoration-color: #ff00ff; font-weight: bold">module</span><span style="font-weight: bold">&gt;</span>
    raise <span style="color: #800080; text-decoration-color: #800080; font-weight: bold">NotImplementedError</span><span style="font-weight: bold">(</span><span style="color: #008000; text-decoration-color: #008000">"expected to fail"</span><span style="font-weight: bold">)</span>
NotImplementedError: expected to fail

</pre>






    RuntimeError('INFO:nbdev_mkdocs.docstring:rich.jupyter.JUPYTER_HTML_FORMAT=\'<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,\\\'DejaVu Sans Mono\\\',consolas,\\\'Courier New\\\',monospace;font-size:.68rem">{code}</pre>\\n\'\nTraceback (most recent call last):\n  File "/tmp/tmpdtxm71jc/example.py", line 4, in <module>\n    raise NotImplementedError("expected to fail")\nNotImplementedError: expected to fail\n')




```
from nbdev_mkdocs.package_data import get_root_data_path

print(get_root_data_path.__doc__)
```

    Returns path to package_data in lib
    
        Example:
            ``` python
            from nbdev_mkdocs.package_data import get_root_data_path
    
            req_path = get_root_data_path() / "requirements.txt"
            print(f"Path is: {req_path.resolve()}")
            assert req_path.exists()
            
            ```
            
        



```
_extract_examples_from_docstring(get_root_data_path)
```




    ['\nfrom nbdev_mkdocs.package_data import get_root_data_path\n\nreq_path = get_root_data_path() / "requirements.txt"\nprint(f"Path is: {req_path.resolve()}")\nassert req_path.exists()\n\n']




```

```
